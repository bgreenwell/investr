<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta http-equiv="x-ua-compatible" content="IE=9" >

<title>investr</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>





</head>

<body>
<h1>investr</h1>

<p><code>investr</code> stands for <strong>inverse estimation in R</strong>. Inverse 
estimation, also referred to as the calibration problem, is in a sense the 
reverse of the prediction problem. Inverse estimation is a classical and well-known problem in regression. In simple terms, it involves the use of an observed value of the response to make inference on the corresponding unknown value of the explanatory variable. To our knowledge, however, statistical software is somewhat lacking the capabilities for analyzing these types of problems. The package is currently listed on CRAN and can easily be installed:</p>

<pre><code class="S">  ## Install from CRAN
  install.packages(&quot;investr&quot;, dep = TRUE)
</code></pre>

<p>The package is also currently listed in the ChemPhys task view (<a href="http://cran.r-project.org/web/views/ChemPhys.html">http://cran.r-project.org/web/views/ChemPhys.html</a>), a collection of R packages useful for analyzing data from chemistry and physics experiments. These packages can all be installed at once (including <code>investr</code>) using the <code>ctv</code> package (Zeileis, 2005):</p>

<pre><code class="S">  ## Install the ChemPhys task view
  install.packages(&quot;ctv&quot;)
  library(&quot;ctv&quot;)
  install.views(&quot;ChemPhys&quot;)
</code></pre>

<p>The development version of <code>investr</code> can be found on GitHub at <a href="https://github.com/w108bmg/investr">https://github.com/w108bmg/investr</a> and can easily be installed using the the <code>devtools</code> package (Wickham and Chang, 2013):</p>

<pre><code class="S">  ## Install development version from GitHub
  install.packages(&quot;devtools&quot;)
  library(devtools)
  install_github(repo = &quot;w108bmg/investr&quot;)
</code></pre>

<p>To report bugs or issues, contact the main author directly or submit them to <a href="https://github.com/w108bmg/investr/issues">https://github.com/w108bmg/investr/issues</a>. </p>

<p>There are currently three main funtions in the <code>investr</code> package:</p>

<ul>
<li><code>plotFit</code>;</li>
<li><code>calibrate</code>;</li>
<li><code>invest</code>;</li>
</ul>

<h2><code>plotFit</code></h2>

<p>The function <code>plotFit</code> produces a scatterplot of the data with fitted regression curve and the option to add confidence/prediction bands for the response (pointwise or adjusted). It can be used with single-predictor objects of class <code>lm</code> or <code>nls</code>; however, for objects of class <code>nls</code>, confidence/prediction bands are based on the linear approximation and can be misleading (Bates and Watts, 1988, pg. 65).</p>

<h3>Usage</h3>

<pre><code class="S">## Load package
library(investr)

## A linear regression example
data(cars, package = &quot;datasets&quot;)
library(splines)
cars.lm1 &lt;- lm(dist ~ speed, data = cars)
cars.lm2 &lt;- lm(dist ~ speed + I(speed^2), data = cars)
cars.lm3 &lt;- lm(dist ~ speed + I(speed^2) + I(speed^3), data = cars)
cars.lm4 &lt;- lm(dist ~ ns(speed, df = 3), data = cars)
par(mfrow = c(2, 2))
plotFit(cars.lm1, interval = &quot;both&quot;, xlim = c(-10, 40), ylim = c(-50, 150), 
        main = &quot;linear&quot;, shade = T)
plotFit(cars.lm2, interval = &quot;both&quot;, xlim = c(-10, 40), ylim = c(-50, 150), 
        main = &quot;quadratic&quot;, shade = T)
plotFit(cars.lm3, interval = &quot;both&quot;, xlim = c(-10, 40), ylim = c(-50, 150), 
        main = &quot;cubic&quot;, shade = T)
plotFit(cars.lm4, interval = &quot;both&quot;, xlim = c(-10, 40), ylim = c(-50, 150), 
        main = &quot;cubic spline&quot;, shade = T)

## A nonlinear regression example
par(mfrow = c(1, 1))
data(Puromycin, package = &quot;datasets&quot;)
Puromycin2 &lt;- Puromycin[Puromycin$state == &quot;treated&quot;, ][, 1:2]
Puro.nls &lt;- nls(rate ~ Vm * conc/(K + conc), data = Puromycin2,
                start = c(Vm = 200, K = 0.05))
plotFit(Puro.nls, interval = &quot;prediction&quot;, pch = 19, shade = T, 
        col.pred = rgb(0, 1, 1, 0.4))

</code></pre>

<h2><code>calibrate</code></h2>

<p><code>calibrate</code> operates on objects of class <code>lm</code> and can only be used with the simple linear regression model.</p>

<h3>Usage</h3>

<pre><code class="S">## Crystal growth data from Graybill &amp; Iyer (1994)
fit &lt;- lm(weight ~ time, data = crystal) 
plotFit(fit, interval = &quot;confidence&quot;, shade = T, col.conf = &quot;lightblue&quot;, 
        pch = 19)
(res &lt;- calibrate(fit, y0 = 8, interval = &quot;inversion&quot;, mean.response = T))
abline(h = 8, v = c(res$lower, res$estimate, res$upper), lty = 2)
</code></pre>

<h2><code>invest</code></h2>

<p>For more complicated models (e.g., polynomial and nonlinear regression), closed-form expressions are usually not available and iterative techniques will be required. This is the purpose of the function <code>invest</code>, which carries out the computations numericall by calling the function <code>uniroot</code> from the <code>stats</code> package.</p>

<h3>Usage</h3>

<pre><code class="S">## Treatment group from Puromycin data frame
plotFit(fit, interval = &quot;prediction&quot;, shade = T, pch = 19)
(res &lt;- invest(Puro.nls, y0 = 150, interval = &quot;inversion&quot;))
abline(h = 150, v = c(res$lower, res$estimate, res$upper))
</code></pre>

</body>

</html>

